# Metadata

The controller broadcasts changes to metadata to other brokers via the
<<UpdateMetadata>> request.

When a broker receives an <<UpdateMetadata>> request it:

* updates its metadata cache, 
* complete any operations which were in purgatory waiting for some change which was present in the new metadata,
* sends a response back to the controller.

When the controller receives an <<UpdateMetadata>> response it basically does nothing (only logs). Thus the logic of the controller does not depend on knowing that a metadata request was received.

ASIDE: I suspect this is because, if a request was not delivered to a broker (e.g. due to crash) then, on restart, the broker will get fresh metadata anyway.

**TODO** How and when does the controller send updatametadata requests

**TODO** Discuss difference between clients and brokers wrt metadata propagation.